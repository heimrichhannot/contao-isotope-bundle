(function(a){window.ISOTOPE_BUNDLE={init:function(){this.initPDFViewer();this.initBookingPlan();this.registerEvents()},registerEvents:function(){a(document).keydown(function(b){if(b.which==13){b.preventDefault();pageNum=parseInt(a("#ctrl-pageNum_"+activeID).val());if(a("#ctrl-pageNum_"+activeID+":focus").length&&pageNum<=pdfDoc.numPages&&pageNum>=1){isotopeBundle.queueRenderPage(pageNum)}}});a("#ctrl-prev_"+activeID).on("click",function(){isotopeBundle.onPrevPage()});a("#ctrl-next_"+activeID).on("click",function(){isotopeBundle.onNextPage()});a(".tabs").on("click",function(){activeID=a(this).data("target");pageNum=parseInt(a("#ctrl-pageNum_"+activeID).val());if(!a("#pdfViewer_"+activeID).hasClass("loaded")){isotopeBundle.initPDFViewer()}})},initPDFViewer:function(){canvas=a("#pdfViewer_"+activeID)[0];ctx=canvas.getContext("2d");url="/"+a("#pdfViewer_"+activeID).data("src");a(loader).appendTo(".pdfViewer-wrapper_"+activeID);isotopeBundle.getDocument(url).then(function(b){pdfDoc=b;a("#pageCount_"+activeID)[0].textContent=pdfDoc.numPages;isotopeBundle.renderPage(pageNum);a(document).find("#loader").remove();a("#pdfViewer_"+activeID).addClass("loaded")})},renderPage:function(b){pageRendering=true;pdfDoc.getPage(b).then(function(f){var c=f.getViewport(scale);canvas.height=c.height;canvas.width=c.width;var e={canvasContext:ctx,viewport:c,};var d=f.render(e);d.promise.then(function(){pageRendering=false;if(pageNumPending!==null){isotopeBundle.renderPage(pageNumPending);pageNumPending=null}})});a("#ctrl-pageNum_"+activeID)[0].textContent=pageNum},queueRenderPage:function(b){if(pageRendering){pageNumPending=b}else{isotopeBundle.renderPage(b)}isotopeBundle.updatePageNum(b)},onPrevPage:function(){if(pageNum<=1){return}pageNum--;isotopeBundle.queueRenderPage(pageNum)},onNextPage:function(){if(pageNum>=pdfDoc.numPages){return}pageNum++;isotopeBundle.queueRenderPage(pageNum)},updatePageNum:function(b){a("#ctrl-pageNum_"+activeID).val(b)},initBookingPlan:function(){var b=a(document).find("#bookingPlan"),c=b.data("blocked");flatpickr("#bookingPlan",{dateFormat:"d.m.Y",minDate:"today",mode:"range",onDayCreate:function(d,e,h,g){var f=g.dateObj;var i=isotopeBundle.getComparableDate(f.getTime());a.each(c,function(j,k){if(k==i){g.className+=" disabled blocked"}})}})},getComparableDate:function(b){str=str.toString().substring(0,10);str=parseInt(str);return str+7200}};a(document).ready(function(){ISOTOPE_BUNDLE.init()})})(jQuery);